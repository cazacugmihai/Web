var Od;(function(n){function yt(){var t=this,i,f,e,r;if(pt(t),i=t.dom,i){kt(t);return}f=t.obs();e=i&&i.parentNode;u(i,null);r=n.patchDom(f,i,e);u(r,t);t.dom=r;a("created",r)}var g=!1,v,y,r;n.text=function(n){return{isIVdom:!0,text:r(n)?"":n.toString()}};n.element=function(n,t,i){n=n.toUpperCase();var r=i?y(i)?i:[i]:null;return{isIVdom:!0,tag:n,props:t,children:r}};n.component=function(t){return n.namedComponent(null,t)};n.namedComponent=function(n,i){var u=nt(n),o;if(u)return u;var f=Obs.isObservable(i)?i:Obs.fn(i),r={isIVdom:!0,obs:f,subscription:null,subcomponents:null,dom:null},e=Obs.subscribe([f],yt.bind(r));return r.subscription=e,tt(n,r),o=t,t=null,e(),r.subcomponents=t,t=o,r};var t=null,nt=function(n){return n&&t&&t[n]},tt=function(n,i){if(t||(t={}),n){t[n]=i;return}""in t||(t[""]=[]);t[""].push(i)};n.fromHtml=function(n){var t=document.createElement("DIV"),i,r;return t.innerHTML=n,i=t.childNodes.length===1?t.firstChild:t,r={isIVdom:!0,obs:p,subscription:w,dom:i},r};n.fromDom=function(n){return{isIVdom:!0,obs:p,subscription:w,dom:n}};n.bind=function(t,i){var r=i.parentNode;n.patchDom(t,i,r)};n.appendChild=function(t,i){n.patchDom(t,null,i)};n.dispose=function(n){n&&(n.obs&&(Obs.dispose(n.obs),n.obs=null),n.subscription&&(Obs.dispose(n.subscription),n.subscription=null),n.dom&&(a("destroyed",n.dom),e(n.dom),n.dom=null),n.subcomponents&&(v(n.subcomponents),n.subcomponents=null))};v=function(t){var i,r;for(i in t)r=t[i],i===""?r.forEach(n.dispose):n.dispose(r)};n.deferComponentUpdates=!0;y=function(n){return n instanceof Array};r=function(n){return n==null};n.patchDom=function(t,i,r){var u=typeof t=="string"?n.text(t):t;return u.tag?ut(u,i,r):u.obs?rt(u,i,r):it(u,i,r)};var it=function(n,t,i){var u=n.text,r=!t||t.nodeName!=="#text"?document.createTextNode(u):t;return r.nodeValue!==u&&(r.nodeValue=u),o(r,t,i),r},rt=function(n,t,i){var r=n.dom;return r!==t&&o(r,t,i),r},ut=function(n,t,r){var e=n.tag,s=n.props,c=n.children,u=t,f=!u||u.tagName!==e||h(u)?document.createElement(e):u;return f!==u&&i("  Created",e),ft(f,s),ht(f,c),o(f,t,r),f},ft=function(n,t){var r=s(n),i,u,f;if(t)for(i in t)i!=="style"&&st(n,i,t[i]);if(r)for(i in r)i in t||ot(n,i);u=r&&r.style;f=t&&t.style;et(n,u,f);lt(n,t)},et=function(n,t,i){var u,r;if(typeof i=="string"){n.style=i;return}if(!i){t&&(n.style=null);return}u=n.style;for(r in i)u[r]=i[r];if(t)for(r in t)r in i||(u[r]=null)},ot=function(n,t){n[t]=null;n instanceof HTMLElement&&n.removeAttribute(t)},st=function(n,t,i){t==="class"&&(t="className");n[t]=i},ht=function(t,r){var u,e,f,s,h,c;for(r||(r=[]),t.keyed&&ct(r,t),u=t.firstChild,e=r.length,f=0;f<e;f++)i("Patching child",f+1),s=r[f],h=n.patchDom(s,u,t).nextSibling,u=h,i("Patched child",f+1);while(u)c=u.nextSibling,o(null,u,t),u=c,i("Removed child",++f)},ct=function(n,t){var c,l,u,s,e,f,h,y,o;i("  Reordering keyed children.");var a=n,p=t.firstChild,v=a.length;if(v!==0&&p){for(c={},u=t.firstChild;u;u=u.nextSibling){if(l=u.key,r(l))return;c[l]=u}for(u=t.firstChild,s=0;s<v;s++){if(e=a[s],f=e.tag,r(f)&&e.dom&&(f=e.dom.nodeName),!f)return;if(h=at(e.props),r(h))return;y=u&&u.key;o=c[h];u?y===h?u=u.nextSibling:o?t.insertBefore(o,u):t.insertBefore(document.createElement(f),u):o?t.appendChild(o):t.appendChild(document.createElement(f))}}},p=Obs.of(null),w=null,ti=function(n){var t,i;if(!n)return null;var r=[],u=Object.keys(n).sort(),f=u.length;for(t=0;t<f;t++)i=u[t],r.push(i,n[i]);return r},s=function(n){return n.__Od__props},lt=function(n,t){n.__Od__props=t},at=function(n){return n&&n.key},vt=function(n){return n.__Od__component},u=function(n,t){n&&(n.__Od__component=t)},h=function(n){return!!vt(n)};var pt=function(t){var i=t.subcomponents&&t.subcomponents[""];i&&(i.forEach(n.dispose),t.subcomponents[""]=null)},wt=function(n){return setTimeout(n,16)},bt=window.requestAnimationFrame||wt,f=[],c=0,kt=function(t){if(!n.deferComponentUpdates){b(t);return}(f.push(t),c)||(c=bt(dt))},dt=function(){for(var r,n,u={},e=f.length,t=0;t<e;t++)(r=f[t],n=r.obs.obsid,u[n])||(i("Patching queued component #",n),b(r),u[n]=!0);f=[];c=0},b=function(t){var f=t.obs(),i=t.dom,o=i&&i.parentNode,r;gt(f,i)?(u(i,null),e(i)):u(i,null);r=n.patchDom(f,i,o);u(r,t);a("updated",r);t.dom=r},gt=function(n,t){return t?typeof n=="string"?t.nodeType!==Node.TEXT_NODE:t.nodeName!==n.tag:!1},l=[],e=function(n){n&&(h(n)||(i("  Discarded",n.nodeName||"#text"),l.push(n),k)||(k=setTimeout(ni,100)))},k=0,ni=function(){for(var n=l.pop();n;)d(n),n=l.pop()},d=function(n){var r,u,i,f,t;if(!h(n)){r=s(n);for(u in r)n[u]=null;for(i=n.childNodes,f=i.length,t=0;t<f;t++)d(i[t])}},o=function(n,t,r){if(n)if(t){if(n===t)return;if(e(t),!r)return;i("  Inserted",n.nodeName||"#text");r&&r.replaceChild(n,t)}else i("  Inserted",n.nodeName||"#text"),r&&r.appendChild(n);else{if(!t)return;e(t);r&&r.removeChild(t)}},a=function(n,t){var i=t&&s(t),r=i&&i.odlifecycle;r&&r(n,t)},i=function(){g&&window.console&&window.console.log&&console.log.apply(console,arguments)}})(Od||(Od={}));